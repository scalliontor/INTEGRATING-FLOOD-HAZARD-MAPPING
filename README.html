<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Event-Based Flood Risk Mapping - Ha Tinh</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      border: none;
      border-top: 1px solid #1a1a1a;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Event-Based Flood Risk Mapping - Ha Tinh</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#event-based-flood-risk-mapping---ha-tinh-province"
id="toc-event-based-flood-risk-mapping---ha-tinh-province">ğŸŒŠ
Event-Based Flood Risk Mapping - Ha Tinh Province</a></li>
<li><a href="#tuyÃªn-bá»‘-dá»±-Ã¡n-1-cÃ¢u" id="toc-tuyÃªn-bá»‘-dá»±-Ã¡n-1-cÃ¢u">ğŸ“‹
TuyÃªn Bá»‘ Dá»± Ãn (1 cÃ¢u)</a></li>
<li><a href="#má»¥c-lá»¥c" id="toc-má»¥c-lá»¥c">Má»¥c Lá»¥c</a></li>
<li><a href="#Ä‘iá»ƒm-khÃ¡c-biá»‡t-so-vá»›i-bÃ i-cÅ©"
id="toc-Ä‘iá»ƒm-khÃ¡c-biá»‡t-so-vá»›i-bÃ i-cÅ©">1. Äiá»ƒm KhÃ¡c Biá»‡t So Vá»›i BÃ i
CÅ©</a>
<ul>
<li><a href="#bÃ i-cÅ©-static-susceptibility---ahpsvm"
id="toc-bÃ i-cÅ©-static-susceptibility---ahpsvm">1.1. BÃ i cÅ© (Static
Susceptibility - AHP+SVM)</a></li>
<li><a href="#bÃ i-má»›i-dynamic-event-based-risk"
id="toc-bÃ i-má»›i-dynamic-event-based-risk">1.2. BÃ i má»›i (Dynamic
Event-Based Risk)</a></li>
<li><a href="#Ä‘iá»ƒm-cá»‘t-lÃµi" id="toc-Ä‘iá»ƒm-cá»‘t-lÃµi">1.3. Äiá»ƒm cá»‘t
lÃµi</a></li>
</ul></li>
<li><a href="#cáº¥u-trÃºc-dá»¯-liá»‡u" id="toc-cáº¥u-trÃºc-dá»¯-liá»‡u">2. Cáº¥u TrÃºc Dá»¯
Liá»‡u</a>
<ul>
<li><a href="#labels-tá»«-sentinel-1-19-bands-19-events"
id="toc-labels-tá»«-sentinel-1-19-bands-19-events">2.1. Labels tá»«
Sentinel-1 (19 bands = 19 events)</a></li>
<li><a href="#static-features-11-bands"
id="toc-static-features-11-bands">2.2. Static Features (11
bands)</a></li>
<li><a href="#dynamic-rainfall-features-76-bands-19-events-4-vars"
id="toc-dynamic-rainfall-features-76-bands-19-events-4-vars">2.3.
Dynamic Rainfall Features (76 bands = 19 events Ã— 4 vars)</a></li>
</ul></li>
<li><a href="#cáº¥u-trÃºc-thÆ°-má»¥c" id="toc-cáº¥u-trÃºc-thÆ°-má»¥c">3. Cáº¥u TrÃºc
ThÆ° Má»¥c</a></li>
<li><a href="#chi-tiáº¿t-scripts" id="toc-chi-tiáº¿t-scripts">4. Chi Tiáº¿t
Scripts</a>
<ul>
<li><a href="#create_dataset.py---táº¡o-dataset-event-based"
id="toc-create_dataset.py---táº¡o-dataset-event-based">4.1.
<code>create_dataset.py</code> - Táº¡o Dataset Event-Based</a></li>
<li><a href="#eda.py---lÃ m-sáº¡ch-eda-cÆ¡-báº£n"
id="toc-eda.py---lÃ m-sáº¡ch-eda-cÆ¡-báº£n">4.2. <code>eda.py</code> - LÃ m
Sáº¡ch + EDA CÆ¡ Báº£n</a></li>
<li><a href="#eda_adv.py---eda-nÃ¢ng-cao"
id="toc-eda_adv.py---eda-nÃ¢ng-cao">4.3. <code>eda_adv.py</code> - EDA
NÃ¢ng Cao</a></li>
<li><a href="#train.py---train-loeo-gpu"
id="toc-train.py---train-loeo-gpu">4.4. <code>train.py</code> - Train
LOEO (GPU)</a></li>
<li><a href="#final_analysis.py---shap-climate-scenario"
id="toc-final_analysis.py---shap-climate-scenario">4.5.
<code>final_analysis.py</code> - SHAP + Climate Scenario</a></li>
</ul></li>
<li><a href="#pipeline-thá»±c-thi" id="toc-pipeline-thá»±c-thi">5. Pipeline
Thá»±c Thi</a></li>
<li><a href="#feature-set" id="toc-feature-set">6. Feature Set</a>
<ul>
<li><a href="#features-Ä‘ang-dÃ¹ng-Ä‘Ã£-bá»-water_mask"
id="toc-features-Ä‘ang-dÃ¹ng-Ä‘Ã£-bá»-water_mask">6.1. 14 Features Ä‘ang dÃ¹ng
(Ä‘Ã£ bá» water_mask)</a></li>
<li><a href="#táº¡i-sao-bá»-water_mask" id="toc-táº¡i-sao-bá»-water_mask">6.2.
Táº¡i sao bá» water_mask?</a></li>
</ul></li>
<li><a href="#danh-sÃ¡ch-19-sá»±-kiá»‡n" id="toc-danh-sÃ¡ch-19-sá»±-kiá»‡n">7.
Danh SÃ¡ch 19 Sá»± Kiá»‡n</a></li>
<li><a href="#káº¿t-quáº£-Ä‘áº¡t-Ä‘Æ°á»£c" id="toc-káº¿t-quáº£-Ä‘áº¡t-Ä‘Æ°á»£c">8. Káº¿t Quáº£ Äáº¡t
ÄÆ°á»£c</a>
<ul>
<li><a href="#loeo-metrics-sau-khi-bá»-water_mask"
id="toc-loeo-metrics-sau-khi-bá»-water_mask">8.1. LOEO Metrics (sau khi
bá» water_mask)</a></li>
<li><a href="#feature-importance-top-5"
id="toc-feature-importance-top-5">8.2. Feature Importance (Top
5)</a></li>
<li><a href="#climate-scenario-observation"
id="toc-climate-scenario-observation">8.3. Climate Scenario
Observation</a></li>
</ul></li>
<li><a href="#viá»‡c-cÃ²n-pháº£i-lÃ m" id="toc-viá»‡c-cÃ²n-pháº£i-lÃ m">9. Viá»‡c CÃ²n
Pháº£i LÃ m</a>
<ul>
<li><a href="#Ä‘Ã£-hoÃ n-thÃ nh" id="toc-Ä‘Ã£-hoÃ n-thÃ nh">âœ… ÄÃ£ hoÃ n
thÃ nh</a></li>
<li><a href="#cÃ²n-thiáº¿u-Ä‘á»ƒ-thÃ nh-paper"
id="toc-cÃ²n-thiáº¿u-Ä‘á»ƒ-thÃ nh-paper">ğŸ”² CÃ²n thiáº¿u (Ä‘á»ƒ thÃ nh paper)</a></li>
</ul></li>
<li><a href="#thÆ°-viá»‡n-yÃªu-cáº§u" id="toc-thÆ°-viá»‡n-yÃªu-cáº§u">10. ThÆ° Viá»‡n
YÃªu Cáº§u</a></li>
</ul>
</nav>
<h1 id="event-based-flood-risk-mapping---ha-tinh-province">ğŸŒŠ
Event-Based Flood Risk Mapping - Ha Tinh Province</h1>
<blockquote>
<p><strong>Data-driven Flood Risk Assessment theo tá»«ng sá»± kiá»‡n
lÅ©</strong><br />
Sentinel-1 + Dynamic Rainfall (CHIRPS) + XGBoost + SHAP</p>
</blockquote>
<p>ğŸ“… <strong>Cáº­p nháº­t:</strong> 2026-02-05<br />
ğŸ“ <strong>Khu vá»±c:</strong> HÃ  TÄ©nh, Viá»‡t Nam<br />
ğŸ›°ï¸ <strong>Dá»¯ liá»‡u:</strong> Sentinel-1 SAR (2016-2025), CHIRPS Daily,
SRTM, ESA WorldCover</p>
<hr />
<h1 id="tuyÃªn-bá»‘-dá»±-Ã¡n-1-cÃ¢u">ğŸ“‹ TuyÃªn Bá»‘ Dá»± Ãn (1 cÃ¢u)</h1>
<blockquote>
<p>Dá»± Ã¡n xÃ¢y dá»±ng há»‡ thá»‘ng Ä‘Ã¡nh giÃ¡ rá»§i ro ngáº­p <strong>theo sá»±
kiá»‡n</strong> cho tá»‰nh HÃ  TÄ©nh báº±ng cÃ¡ch káº¿t há»£p nhÃ£n ngáº­p Sentinel-1
(conservative, event-based) vá»›i Ä‘á»‹a hÃ¬nhâ€“máº·t phá»§ vÃ  <strong>Ä‘áº·c trÆ°ng
mÆ°a CHIRPS theo tá»«ng sá»± kiá»‡n</strong>. MÃ´ hÃ¬nh XGBoost Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡
báº±ng <strong>Leave-One-Event-Out (LOEO)</strong> Ä‘á»ƒ kiá»ƒm tra kháº£ nÄƒng dá»±
bÃ¡o cho má»™t tráº­n lÅ© chÆ°a tá»«ng tháº¥y. Káº¿t quáº£ Ä‘Æ°á»£c giáº£i thÃ­ch báº±ng SHAP vÃ 
má»Ÿ rá»™ng Ä‘á»ƒ mÃ´ phá»ng ká»‹ch báº£n <strong>mÆ°a cá»±c Ä‘oan tÄƒng 20%</strong>.</p>
</blockquote>
<hr />
<h1 id="má»¥c-lá»¥c">Má»¥c Lá»¥c</h1>
<ol type="1">
<li><a href="#1-Ä‘iá»ƒm-khÃ¡c-biá»‡t-so-vá»›i-bÃ i-cÅ©">Äiá»ƒm KhÃ¡c Biá»‡t So Vá»›i BÃ i
CÅ©</a></li>
<li><a href="#2-cáº¥u-trÃºc-dá»¯-liá»‡u">Cáº¥u TrÃºc Dá»¯ Liá»‡u</a></li>
<li><a href="#3-cáº¥u-trÃºc-thÆ°-má»¥c">Cáº¥u TrÃºc ThÆ° Má»¥c</a></li>
<li><a href="#4-chi-tiáº¿t-scripts">Chi Tiáº¿t Scripts</a></li>
<li><a href="#5-pipeline-thá»±c-thi">Pipeline Thá»±c Thi</a></li>
<li><a href="#6-feature-set">Feature Set</a></li>
<li><a href="#7-danh-sÃ¡ch-19-sá»±-kiá»‡n">Danh SÃ¡ch 19 Sá»± Kiá»‡n</a></li>
<li><a href="#8-káº¿t-quáº£-Ä‘áº¡t-Ä‘Æ°á»£c">Káº¿t Quáº£ Äáº¡t ÄÆ°á»£c</a></li>
<li><a href="#9-viá»‡c-cÃ²n-pháº£i-lÃ m">Viá»‡c CÃ²n Pháº£i LÃ m</a></li>
</ol>
<hr />
<h1 id="Ä‘iá»ƒm-khÃ¡c-biá»‡t-so-vá»›i-bÃ i-cÅ©">1. Äiá»ƒm KhÃ¡c Biá»‡t So Vá»›i BÃ i
CÅ©</h1>
<h2 id="bÃ i-cÅ©-static-susceptibility---ahpsvm">1.1. BÃ i cÅ© (Static
Susceptibility - AHP+SVM)</h2>
<table>
<thead>
<tr>
<th>Äáº·c Ä‘iá»ƒm</th>
<th>BÃ i cÅ©</th>
</tr>
</thead>
<tbody>
<tr>
<td>Biáº¿n Ä‘áº§u vÃ o</td>
<td>Chá»‰ <strong>tÄ©nh</strong> (DEM, slope, dist riverâ€¦)</td>
</tr>
<tr>
<td>MÆ°a</td>
<td>Trung bÃ¬nh nhiá»u nÄƒm / Annual mean</td>
</tr>
<tr>
<td>Label</td>
<td>Proxy tá»« AHP/heuristic (khÃ´ng pháº£i lÅ© thá»±c)</td>
</tr>
<tr>
<td>Äáº§u ra</td>
<td>â€œÄiá»ƒm nháº¡y cáº£mâ€ khÃ´ng gáº¯n vá»›i thá»i Ä‘iá»ƒm</td>
</tr>
<tr>
<td>CÃ¢u há»i khÃ´ng tráº£ lá»i Ä‘Æ°á»£c</td>
<td>â€œMÆ°a tÄƒng 20% thÃ¬ rá»§i ro tÄƒng á»Ÿ Ä‘Ã¢u?â€</td>
</tr>
</tbody>
</table>
<h2 id="bÃ i-má»›i-dynamic-event-based-risk">1.2. BÃ i má»›i (Dynamic
Event-Based Risk)</h2>
<table>
<colgroup>
<col style="width: 52%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr>
<th>Äáº·c Ä‘iá»ƒm</th>
<th>BÃ i má»›i</th>
</tr>
</thead>
<tbody>
<tr>
<td>Biáº¿n Ä‘áº§u vÃ o</td>
<td><strong>TÄ©nh + Äá»™ng</strong> (Rain_3D, Rain_7D, Rain_Max,
Rain_AM14)</td>
</tr>
<tr>
<td>MÆ°a</td>
<td><strong>Tá»•ng mÆ°a tá»«ng sá»± kiá»‡n</strong> tá»« CHIRPS</td>
</tr>
<tr>
<td>Label</td>
<td><strong>Ngáº­p quan sÃ¡t thá»±c táº¿</strong> tá»« Sentinel-1</td>
</tr>
<tr>
<td>Äáº§u ra</td>
<td>XÃ¡c suáº¥t ngáº­p P(x|event) + Expected frequency</td>
</tr>
<tr>
<td>Kháº£ nÄƒng má»›i</td>
<td>MÃ´ phá»ng ká»‹ch báº£n BÄKH (Rain Ã— 1.2)</td>
</tr>
</tbody>
</table>
<h2 id="Ä‘iá»ƒm-cá»‘t-lÃµi">1.3. Äiá»ƒm cá»‘t lÃµi</h2>
<p>Má»—i dÃ²ng dá»¯ liá»‡u cÃ³ dáº¡ng:</p>
<pre><code>(Pixel_i, Event_e)  â†’  [X_static(i), X_rain(i,e), y(i,e)]</code></pre>
<p><strong>CÃ¹ng má»™t pixel</strong> cÃ³ thá»ƒ: - KhÃ´ng ngáº­p á»Ÿ event mÆ°a nhá»
- Ngáº­p á»Ÿ event mÆ°a lá»›n</p>
<p>â‡’ Model buá»™c pháº£i há»c <strong>â€œmÆ°a Ã— Ä‘á»‹a hÃ¬nhâ€</strong>, khÃ´ng thá»ƒ
chá»‰ há»c â€œvÃ¹ng trÅ©ngâ€.</p>
<hr />
<h1 id="cáº¥u-trÃºc-dá»¯-liá»‡u">2. Cáº¥u TrÃºc Dá»¯ Liá»‡u</h1>
<h2 id="labels-tá»«-sentinel-1-19-bands-19-events">2.1. Labels tá»«
Sentinel-1 (19 bands = 19 events)</h2>
<pre><code>flood_baseline/HaTinh_Flood_Stack_19Events_FullLogic.tif
â”œâ”€â”€ Band 01: 01_2016_Lu_Ho_Ho (0/1)
â”œâ”€â”€ Band 02: 02_2016_Lu_T11_Dot2 (0/1)
â”œâ”€â”€ ...
â””â”€â”€ Band 19: 19_2025_Lu_T11 (0/1)</code></pre>
<p><strong>Quy trÃ¬nh táº¡o label (conservative):</strong> 1. Sentinel-1
VH, IW mode, DESCENDING orbit 2. Mask gÃ³c nghiÃªng (31Â°-45Â°) 3. Min
composite theo event window 4. Focal median 50m (lá»c speckle) 5.
Threshold VH &lt; -19 dB 6. Slope mask &lt; 10Â° 7. <strong>Loáº¡i
permanent water</strong> (ESA class 80) 8. Remove blobs &lt; 20
pixels</p>
<h2 id="static-features-11-bands">2.2. Static Features (11 bands)</h2>
<pre><code>input/HaTinh_Static_Full_Features_11Bands.tif
â”œâ”€â”€ Band 01: elevation     â†’ Äá»™ cao (m)
â”œâ”€â”€ Band 02: slope         â†’ Äá»™ dá»‘c (Â°)
â”œâ”€â”€ Band 03: aspect        â†’ HÆ°á»›ng sÆ°á»n (Â°)
â”œâ”€â”€ Band 04: curv_lap      â†’ Äá»™ cong Laplacian
â”œâ”€â”€ Band 05: relief_2km    â†’ ChÃªnh cao so vá»›i Ä‘Ã¡y thung lÅ©ng
â”œâ”€â”€ Band 06: twi           â†’ Topographic Wetness Index
â”œâ”€â”€ Band 07: flow_acc      â†’ Flow Accumulation
â”œâ”€â”€ Band 08: dist_water    â†’ Khoáº£ng cÃ¡ch Ä‘áº¿n máº·t nÆ°á»›c (m)
â”œâ”€â”€ Band 09: water_mask    â†’ [ÄÃƒ Bá» khi train] Mask nÆ°á»›c vÄ©nh cá»­u
â”œâ”€â”€ Band 10: lulc          â†’ Land Use Land Cover (class)
â””â”€â”€ Band 11: precip_clim   â†’ MÆ°a khÃ­ háº­u (WorldClim BIO16)</code></pre>
<h2 id="dynamic-rainfall-features-76-bands-19-events-4-vars">2.3.
Dynamic Rainfall Features (76 bands = 19 events Ã— 4 vars)</h2>
<pre><code>input/HaTinh_Rain_Stack_CHIRPS_19Events_4Vars.tif
â”œâ”€â”€ 01_2016_Lu_Ho_Ho_Rain_3D    â†’ Tá»•ng mÆ°a 3 ngÃ y (kÃ­ch hoáº¡t lÅ© nhanh)
â”œâ”€â”€ 01_2016_Lu_Ho_Ho_Rain_7D    â†’ Tá»•ng mÆ°a 7 ngÃ y (tÃ­ch nÆ°á»›c há»“/sÃ´ng)
â”œâ”€â”€ 01_2016_Lu_Ho_Ho_Rain_Max   â†’ NgÃ y mÆ°a lá»›n nháº¥t trong 7 ngÃ y
â”œâ”€â”€ 01_2016_Lu_Ho_Ho_Rain_AM14  â†’ Äá»™ áº©m Ä‘áº¥t trÆ°á»›c lÅ© (14 ngÃ y, cÃ³ trá»ng sá»‘)
â”œâ”€â”€ ...
â””â”€â”€ 19_2025_Lu_T11_Rain_AM14</code></pre>
<p><strong>CÃ´ng thá»©c Rain_AM14 (Antecedent Moisture):</strong></p>
<pre><code>AM14 = Î£ (Rain_day_i Ã— 0.9^i)  vá»›i i = 1..14</code></pre>
<p>NgÃ y hÃ´m qua w=0.9, 14 ngÃ y trÆ°á»›c wâ‰ˆ0.2</p>
<hr />
<h1 id="cáº¥u-trÃºc-thÆ°-má»¥c">3. Cáº¥u TrÃºc ThÆ° Má»¥c</h1>
<pre><code>flood risk/
â”‚
â”œâ”€â”€ ğŸ“„ README.md                                    # File nÃ y
â”œâ”€â”€ ğŸ“„ Event_based_Flood_Susceptibility_*.pdf       # Report PDF
â”‚
â”œâ”€â”€ ğŸ“ scripts/                                     # â­ Code Python + Output
â”‚   â”œâ”€â”€ create_dataset.py                           # Táº¡o dataset event-based
â”‚   â”œâ”€â”€ eda.py                                      # LÃ m sáº¡ch + EDA cÆ¡ báº£n
â”‚   â”œâ”€â”€ eda_adv.py                                  # EDA nÃ¢ng cao
â”‚   â”œâ”€â”€ train.py                                    # Train LOEO (GPU)
â”‚   â”œâ”€â”€ final_analysis.py                           # SHAP + Climate scenario
â”‚   â”‚
â”‚   â”œâ”€â”€ HaTinh_EventBased_Training_Data_Final.csv   # Dataset gá»‘c (~190k rows)
â”‚   â”œâ”€â”€ HaTinh_Training_Ready_Clean.csv             # Dataset Ä‘Ã£ clean (~156k rows)
â”‚   â”œâ”€â”€ LOEO_Metrics_NoWaterMask.csv                # Káº¿t quáº£ LOEO
â”‚   â”œâ”€â”€ XGBoost_Flood_Model_Final.json/.pkl         # Model Ä‘Ã£ train
â”‚   â”‚
â”‚   â””â”€â”€ *.png                                       # CÃ¡c biá»ƒu Ä‘á»“ output
â”‚       â”œâ”€â”€ EDA_Hard_Negatives_Check.png
â”‚       â”œâ”€â”€ EDA_Rain_Signal_Check.png
â”‚       â”œâ”€â”€ EDA_Rain_Distribution_Per_Event.png
â”‚       â”œâ”€â”€ EDA_Terrain_Interaction_Heatmap.png
â”‚       â”œâ”€â”€ Feature_Importance_NoWaterMask.png
â”‚       â”œâ”€â”€ Final_SHAP_Summary.png
â”‚       â”œâ”€â”€ Final_SHAP_Rain7D.png
â”‚       â””â”€â”€ Climate_Change_Impact.png
â”‚
â”œâ”€â”€ ğŸ“ input/                                       # Dá»¯ liá»‡u Ä‘áº§u vÃ o (GEE)
â”‚   â”œâ”€â”€ hatinh_input_feature.js                     # GEE: Táº¡o Static 11 bands
â”‚   â”œâ”€â”€ recip.js                                    # GEE: Táº¡o Rain 76 bands
â”‚   â”œâ”€â”€ HaTinh_Static_Full_Features_11Bands.tif     # ~207MB
â”‚   â””â”€â”€ HaTinh_Rain_Stack_CHIRPS_19Events_4Vars.tif # ~113KB
â”‚
â”œâ”€â”€ ğŸ“ flood_baseline/                              # Labels tá»« Sentinel-1
â”‚   â”œâ”€â”€ flood_baseline.js                           # GEE: Táº¡o label stack
â”‚   â””â”€â”€ HaTinh_Flood_Stack_19Events_FullLogic.tif   # ~3MB
â”‚
â”œâ”€â”€ ğŸ“ AOI_level2/                                  # Shapefile ranh giá»›i huyá»‡n
â”‚   â””â”€â”€ HaTinh_Districts_Level2.*                   # 13 huyá»‡n/TX/TP
â”‚
â”œâ”€â”€ ğŸ“ docs/                                        # TÃ i liá»‡u tham kháº£o
â””â”€â”€ ğŸ“ venv/                                        # Python environment</code></pre>
<hr />
<h1 id="chi-tiáº¿t-scripts">4. Chi Tiáº¿t Scripts</h1>
<h2 id="create_dataset.py---táº¡o-dataset-event-based">4.1.
<code>create_dataset.py</code> - Táº¡o Dataset Event-Based</h2>
<h3 id="má»¥c-Ä‘Ã­ch">Má»¥c Ä‘Ã­ch</h3>
<p>TrÃ­ch xuáº¥t samples tá»« rasters theo tá»«ng event vá»›i <strong>Hard
Negative Mining</strong>.</p>
<h3 id="input">Input</h3>
<table>
<colgroup>
<col style="width: 46%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr>
<th>File</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>flood_baseline/HaTinh_Flood_Stack_19Events_*.tif</code></td>
<td>Labels (19 bands)</td>
</tr>
<tr>
<td><code>input/HaTinh_Static_Full_Features_11Bands.tif</code></td>
<td>Static features</td>
</tr>
<tr>
<td><code>input/HaTinh_Rain_Stack_CHIRPS_19Events_4Vars.tif</code></td>
<td>Rain features</td>
</tr>
</tbody>
</table>
<h3 id="output">Output</h3>
<table>
<thead>
<tr>
<th>File</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HaTinh_EventBased_Training_Data_Final.csv</code></td>
<td>~190k rows</td>
</tr>
</tbody>
</table>
<h3 id="chiáº¿n-lÆ°á»£c-sampling">Chiáº¿n lÆ°á»£c sampling</h3>
<p><strong>Vá»›i má»—i event e (19 events):</strong></p>
<table>
<thead>
<tr>
<th>Loáº¡i</th>
<th>Sá»‘ lÆ°á»£ng</th>
<th>Äiá»u kiá»‡n</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Positive</strong></td>
<td>5000</td>
<td>y(i,e) = 1 (ngáº­p)</td>
</tr>
<tr>
<td><strong>Hard Negative</strong></td>
<td>2500</td>
<td>y=0, slope&lt;5Â°, dist_water&lt;1000m</td>
</tr>
<tr>
<td><strong>Random Negative</strong></td>
<td>2500</td>
<td>y=0, ngoÃ i hard zone</td>
</tr>
</tbody>
</table>
<p><strong>Hard Negative</strong> = vÃ¹ng <strong>tháº¥p trÅ©ng, gáº§n sÃ´ng
nhÆ°ng KHÃ”NG ngáº­p</strong> â†’ buá»™c model há»c tinh táº¿ hÆ¡n.</p>
<h3 id="cÃ¡c-cá»™t-trong-dataset">CÃ¡c cá»™t trong dataset</h3>
<pre><code>Event_ID, Event_Name, X, Y, Label, Is_Hard_Neg,
elev, slope, aspect, curv, relief, twi, flow_acc, dist_water, water_mask, lulc, precip_clim,
Rain_3D, Rain_7D, Rain_Max, Rain_AM14</code></pre>
<hr />
<h2 id="eda.py---lÃ m-sáº¡ch-eda-cÆ¡-báº£n">4.2. <code>eda.py</code> - LÃ m
Sáº¡ch + EDA CÆ¡ Báº£n</h2>
<h3 id="má»¥c-Ä‘Ã­ch-1">Má»¥c Ä‘Ã­ch</h3>
<p>Loáº¡i bá» NaN vÃ  váº½ EDA kiá»ƒm tra cháº¥t lÆ°á»£ng data.</p>
<h3 id="quy-trÃ¬nh">Quy trÃ¬nh</h3>
<ol type="1">
<li><code>dropna()</code> â†’ giáº£m tá»« ~190k xuá»‘ng ~156k rows</li>
<li>Váº½ <strong>Hard Negatives Check</strong>: Boxplot slope/dist_water
theo 3 nhÃ³m</li>
<li>Váº½ <strong>Rain Signal Check</strong>: Boxplot Rain_7D/AM14 theo
Label</li>
</ol>
<h3 id="output-1">Output</h3>
<table>
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr>
<th>File</th>
<th>Ã nghÄ©a</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HaTinh_Training_Ready_Clean.csv</code></td>
<td>Dataset sáº¡ch</td>
</tr>
<tr>
<td><code>EDA_Hard_Negatives_Check.png</code></td>
<td>Ká»³ vá»ng: Hard Neg cÃ³ slope tháº¥p, gáº§n sÃ´ng</td>
</tr>
<tr>
<td><code>EDA_Rain_Signal_Check.png</code></td>
<td>Ká»³ vá»ng: Ngáº­p cÃ³ mÆ°a cao hÆ¡n</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="eda_adv.py---eda-nÃ¢ng-cao">4.3. <code>eda_adv.py</code> - EDA
NÃ¢ng Cao</h2>
<h3 id="plot-1-rain-distribution-per-event">Plot 1: Rain Distribution
Per Event</h3>
<p>Median Rain_7D cá»§a nhÃ³m Ngáº­p vs KhÃ´ng Ngáº­p theo tá»«ng event.</p>
<h3 id="plot-2-terrain-interaction-heatmap">Plot 2: Terrain Interaction
Heatmap</h3>
<p>XÃ¡c suáº¥t ngáº­p thá»±c táº¿ trong lÆ°á»›i (Elevation bins Ã— Slope bins).</p>
<p>â†’ GiÃºp hiá»ƒu <strong>interaction</strong> giá»¯a Ä‘á»‹a hÃ¬nh vÃ  ngáº­p.</p>
<hr />
<h2 id="train.py---train-loeo-gpu">4.4. <code>train.py</code> - Train
LOEO (GPU)</h2>
<h3 id="má»¥c-Ä‘Ã­ch-2">Má»¥c Ä‘Ã­ch</h3>
<p>Huáº¥n luyá»‡n XGBoost vá»›i <strong>Leave-One-Event-Out</strong>
validation.</p>
<h3 id="quan-trá»ng-Ä‘Ã£-bá»-water_mask">âš ï¸ QUAN TRá»ŒNG: ÄÃ£ bá»
<code>water_mask</code></h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bá» &#39;water_mask&#39; khá»i features Ä‘á»ƒ trÃ¡nh Data Leakage</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> [</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;elev&#39;</span>, <span class="st">&#39;slope&#39;</span>, <span class="st">&#39;aspect&#39;</span>, <span class="st">&#39;curv&#39;</span>, <span class="st">&#39;relief&#39;</span>, <span class="st">&#39;twi&#39;</span>, <span class="st">&#39;flow_acc&#39;</span>, <span class="st">&#39;dist_water&#39;</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;lulc&#39;</span>, <span class="st">&#39;precip_clim&#39;</span>,  <span class="co"># â† ÄÃ£ bá» &#39;water_mask&#39;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Rain_3D&#39;</span>, <span class="st">&#39;Rain_7D&#39;</span>, <span class="st">&#39;Rain_Max&#39;</span>, <span class="st">&#39;Rain_AM14&#39;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>]  <span class="co"># 14 features</span></span></code></pre></div>
<h3 id="loeo-validation">LOEO Validation</h3>
<pre><code>Vá»›i 19 events:
  For e in [1..19]:
    Train trÃªn 18 events (táº¥t cáº£ trá»« e)
    Test trÃªn event e (chÆ°a tá»«ng tháº¥y)
    â†’ TÃ­nh AUC, Precision, Recall, F1</code></pre>
<h3 id="hyperparameters">Hyperparameters</h3>
<table>
<thead>
<tr>
<th>Param</th>
<th>GiÃ¡ trá»‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>n_estimators</td>
<td>500</td>
</tr>
<tr>
<td>max_depth</td>
<td>8</td>
</tr>
<tr>
<td>learning_rate</td>
<td>0.05</td>
</tr>
<tr>
<td>tree_method</td>
<td>hist</td>
</tr>
<tr>
<td>device</td>
<td><strong>cuda</strong> (GPU)</td>
</tr>
</tbody>
</table>
<h3 id="output-2">Output</h3>
<table>
<thead>
<tr>
<th>File</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LOEO_Metrics_NoWaterMask.csv</code></td>
<td>Metrics cá»§a 19 events</td>
</tr>
<tr>
<td><code>Feature_Importance_NoWaterMask.png</code></td>
<td>Importance trung bÃ¬nh</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="final_analysis.py---shap-climate-scenario">4.5.
<code>final_analysis.py</code> - SHAP + Climate Scenario</h2>
<h3 id="pháº§n-1-train-final-model">Pháº§n 1: Train Final Model</h3>
<p>Train trÃªn <strong>toÃ n bá»™ data</strong> (khÃ´ng split) Ä‘á»ƒ cÃ³ model
máº¡nh nháº¥t.</p>
<h3 id="pháº§n-2-lÆ°u-model">Pháº§n 2: LÆ°u Model</h3>
<table>
<thead>
<tr>
<th>Format</th>
<th>File</th>
</tr>
</thead>
<tbody>
<tr>
<td>JSON (nháº¹, tÆ°Æ¡ng thÃ­ch)</td>
<td><code>XGBoost_Flood_Model_Final.json</code></td>
</tr>
<tr>
<td>Pickle (tiá»‡n Python)</td>
<td><code>XGBoost_Flood_Model_Final.pkl</code></td>
</tr>
</tbody>
</table>
<h3 id="pháº§n-3-shap-analysis">Pháº§n 3: SHAP Analysis</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.TreeExplainer(model)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer.shap_values(X)</span></code></pre></div>
<table>
<thead>
<tr>
<th>Output</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Final_SHAP_Summary.png</code></td>
<td>Beeswarm global importance</td>
</tr>
<tr>
<td><code>Final_SHAP_Rain7D.png</code></td>
<td>Dependence plot Rain_7D</td>
</tr>
</tbody>
</table>
<h3 id="pháº§n-4-climate-scenario-mÆ°a-20">Pháº§n 4: Climate Scenario (MÆ°a
+20%)</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> [<span class="st">&#39;Rain_3D&#39;</span>, <span class="st">&#39;Rain_7D&#39;</span>, <span class="st">&#39;Rain_Max&#39;</span>, <span class="st">&#39;Rain_AM14&#39;</span>]:</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    X_scenario[col] <span class="op">=</span> X_scenario[col] <span class="op">*</span> <span class="fl">1.2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>prob_baseline <span class="op">=</span> model.predict_proba(X)[:, <span class="dv">1</span>]</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>prob_scenario <span class="op">=</span> model.predict_proba(X_scenario)[:, <span class="dv">1</span>]</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>Î”P <span class="op">=</span> prob_scenario <span class="op">-</span> prob_baseline</span></code></pre></div>
<table>
<thead>
<tr>
<th>Output</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Climate_Change_Impact.png</code></td>
<td>Bar chart Î”P theo event</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="pipeline-thá»±c-thi">5. Pipeline Thá»±c Thi</h1>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> scripts/</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># BÆ°á»›c 1: Táº¡o dataset (náº¿u chÆ°a cÃ³)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> create_dataset.py</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># BÆ°á»›c 2: Clean + EDA cÆ¡ báº£n</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> eda.py</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># BÆ°á»›c 3: EDA nÃ¢ng cao (optional)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> eda_adv.py</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># BÆ°á»›c 4: Train LOEO</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> train.py</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="co"># BÆ°á»›c 5: SHAP + Climate Scenario</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> final_analysis.py</span></code></pre></div>
<hr />
<h1 id="feature-set">6. Feature Set</h1>
<h2 id="features-Ä‘ang-dÃ¹ng-Ä‘Ã£-bá»-water_mask">6.1. 14 Features Ä‘ang dÃ¹ng
(Ä‘Ã£ bá» water_mask)</h2>
<table>
<thead>
<tr>
<th>#</th>
<th>TÃªn</th>
<th>Loáº¡i</th>
<th>Nguá»“n</th>
<th>MÃ´ táº£</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>elev</td>
<td>Static</td>
<td>SRTM</td>
<td>Äá»™ cao (m)</td>
</tr>
<tr>
<td>2</td>
<td>slope</td>
<td>Static</td>
<td>SRTM</td>
<td>Äá»™ dá»‘c (Â°)</td>
</tr>
<tr>
<td>3</td>
<td>aspect</td>
<td>Static</td>
<td>SRTM</td>
<td>HÆ°á»›ng sÆ°á»n (Â°)</td>
</tr>
<tr>
<td>4</td>
<td>curv</td>
<td>Static</td>
<td>SRTM</td>
<td>Äá»™ cong Laplacian</td>
</tr>
<tr>
<td>5</td>
<td>relief</td>
<td>Static</td>
<td>SRTM</td>
<td>ChÃªnh cao so vá»›i thung lÅ©ng</td>
</tr>
<tr>
<td>6</td>
<td>twi</td>
<td>Static</td>
<td>HydroSHEDS</td>
<td>Topographic Wetness Index</td>
</tr>
<tr>
<td>7</td>
<td>flow_acc</td>
<td>Static</td>
<td>HydroSHEDS</td>
<td>Flow Accumulation</td>
</tr>
<tr>
<td>8</td>
<td>dist_water</td>
<td>Static</td>
<td>ESA</td>
<td>Khoáº£ng cÃ¡ch Ä‘áº¿n máº·t nÆ°á»›c</td>
</tr>
<tr>
<td>9</td>
<td>lulc</td>
<td>Static</td>
<td>ESA</td>
<td>Land Use (categorical)</td>
</tr>
<tr>
<td>10</td>
<td>precip_clim</td>
<td>Static</td>
<td>WorldClim</td>
<td>MÆ°a khÃ­ háº­u BIO16</td>
</tr>
<tr>
<td>11</td>
<td>Rain_3D</td>
<td><strong>Dynamic</strong></td>
<td>CHIRPS</td>
<td>Tá»•ng mÆ°a 3 ngÃ y</td>
</tr>
<tr>
<td>12</td>
<td>Rain_7D</td>
<td><strong>Dynamic</strong></td>
<td>CHIRPS</td>
<td>Tá»•ng mÆ°a 7 ngÃ y</td>
</tr>
<tr>
<td>13</td>
<td>Rain_Max</td>
<td><strong>Dynamic</strong></td>
<td>CHIRPS</td>
<td>MÆ°a max 1 ngÃ y trong 7D</td>
</tr>
<tr>
<td>14</td>
<td>Rain_AM14</td>
<td><strong>Dynamic</strong></td>
<td>CHIRPS</td>
<td>Äá»™ áº©m Ä‘áº¥t trÆ°á»›c lÅ©</td>
</tr>
</tbody>
</table>
<h2 id="táº¡i-sao-bá»-water_mask">6.2. Táº¡i sao bá» water_mask?</h2>
<p><strong>Váº¥n Ä‘á» Data Leakage:</strong> - <code>water_mask</code> =
permanent water (sÃ´ng/há»“) tá»« ESA - Label Ä‘Ã£ Ä‘Æ°á»£c táº¡o báº±ng cÃ¡ch
<strong>trá»« Ä‘i</strong> permanent water - â‡’ water_mask = 1 â†’ Label cháº¯c
cháº¯n = 0 (shortcut!)</p>
<p><strong>Sau khi bá»:</strong> - Feature importance trá»Ÿ vá» há»£p lÃ½ -
<code>elev</code>, <code>dist_water</code>, <code>Rain_7D</code> lÃªn top
- Model há»c Ä‘Ãºng quan há»‡ thá»±c</p>
<hr />
<h1 id="danh-sÃ¡ch-19-sá»±-kiá»‡n">7. Danh SÃ¡ch 19 Sá»± Kiá»‡n</h1>
<table>
<thead>
<tr>
<th>ID</th>
<th>TÃªn</th>
<th>T0 (Start)</th>
<th>Window</th>
</tr>
</thead>
<tbody>
<tr>
<td>01</td>
<td>2016_Lu_Ho_Ho</td>
<td>2016-10-10</td>
<td>10-25/10</td>
</tr>
<tr>
<td>02</td>
<td>2016_Lu_T11_Dot2</td>
<td>2016-10-28</td>
<td>28/10-15/11</td>
</tr>
<tr>
<td>03</td>
<td>2017_Bao_So_2</td>
<td>2017-07-14</td>
<td>14-30/07</td>
</tr>
<tr>
<td>04</td>
<td>2017_ATND_Sau_Bao</td>
<td>2017-10-05</td>
<td>05-25/10</td>
</tr>
<tr>
<td>05</td>
<td>2018_Mua_T7</td>
<td>2018-07-12</td>
<td>12-30/07</td>
</tr>
<tr>
<td>06</td>
<td>2019_Lu_Dau_Mua</td>
<td>2019-08-30</td>
<td>30/08-15/09</td>
</tr>
<tr>
<td>07</td>
<td>2019_Lu_T10</td>
<td>2019-10-10</td>
<td>10-25/10</td>
</tr>
<tr>
<td>08</td>
<td>2020_Bao_So_5</td>
<td>2020-09-15</td>
<td>15-30/09</td>
</tr>
<tr>
<td>09</td>
<td>2020_Lu_Dau_T10</td>
<td>2020-10-02</td>
<td>02-14/10</td>
</tr>
<tr>
<td>10</td>
<td><strong>2020_DAI_HONG_THUY</strong></td>
<td>2020-10-15</td>
<td>15/10-05/11</td>
</tr>
<tr>
<td>11</td>
<td>2021_Lu_T9</td>
<td>2021-09-19</td>
<td>19/09-05/10</td>
</tr>
<tr>
<td>12</td>
<td>2021_Lu_T10_Dot1</td>
<td>2021-10-12</td>
<td>12-25/10</td>
</tr>
<tr>
<td>13</td>
<td>2021_Lu_T10_Dot2</td>
<td>2021-10-24</td>
<td>24/10-05/11</td>
</tr>
<tr>
<td>14</td>
<td>2022_Bao_Noru</td>
<td>2022-09-24</td>
<td>24/09-15/10</td>
</tr>
<tr>
<td>15</td>
<td>2023_Lu_T9</td>
<td>2023-09-22</td>
<td>22/09-07/10</td>
</tr>
<tr>
<td>16</td>
<td>2023_Lu_Vu_Quang</td>
<td>2023-10-25</td>
<td>25/10-15/11</td>
</tr>
<tr>
<td>17</td>
<td>2024_Sau_Bao_Soulik</td>
<td>2024-09-15</td>
<td>15/09-05/10</td>
</tr>
<tr>
<td>18</td>
<td>2025_Lu_Bat_Thuong_T5</td>
<td>2025-05-15</td>
<td>15/05-05/06</td>
</tr>
<tr>
<td>19</td>
<td>2025_Lu_T11</td>
<td>2025-10-25</td>
<td>25/10-15/11</td>
</tr>
</tbody>
</table>
<hr />
<h1 id="káº¿t-quáº£-Ä‘áº¡t-Ä‘Æ°á»£c">8. Káº¿t Quáº£ Äáº¡t ÄÆ°á»£c</h1>
<h2 id="loeo-metrics-sau-khi-bá»-water_mask">8.1. LOEO Metrics (sau khi
bá» water_mask)</h2>
<table>
<thead>
<tr>
<th>Metric</th>
<th>GiÃ¡ trá»‹ trung bÃ¬nh</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>AUC</strong></td>
<td>~0.90</td>
</tr>
<tr>
<td><strong>Precision</strong></td>
<td>~0.86</td>
</tr>
<tr>
<td><strong>Recall</strong></td>
<td>~0.84</td>
</tr>
<tr>
<td><strong>F1</strong></td>
<td>~0.85</td>
</tr>
</tbody>
</table>
<h2 id="feature-importance-top-5">8.2. Feature Importance (Top 5)</h2>
<ol type="1">
<li><strong>lulc</strong> - Land use (tÃ¡c Ä‘á»™ng máº¡nh)</li>
<li><strong>dist_water</strong> - Khoáº£ng cÃ¡ch sÃ´ng</li>
<li><strong>elev</strong> - Äá»™ cao</li>
<li><strong>Rain_7D</strong> - MÆ°a 7 ngÃ y</li>
<li><strong>relief</strong> - ChÃªnh cao Ä‘á»‹a hÃ¬nh</li>
</ol>
<h2 id="climate-scenario-observation">8.3. Climate Scenario
Observation</h2>
<p>âš ï¸ <strong>LÆ°u Ã½ quan trá»ng:</strong> - Má»™t sá»‘ events cÃ³ Î”P Ã¢m (giáº£m
rá»§i ro) â†’ khÃ´ng thá»ƒ káº¿t luáº­n theo mean - Cáº§n aggregation Ä‘Ãºng: chá»‰ tÃ­nh
trÃªn <strong>floodplain/lowland</strong> hoáº·c tÃ­nh <strong>% diá»‡n tÃ­ch
&gt; threshold</strong></p>
<hr />
<h1 id="viá»‡c-cÃ²n-pháº£i-lÃ m">9. Viá»‡c CÃ²n Pháº£i LÃ m</h1>
<h2 id="Ä‘Ã£-hoÃ n-thÃ nh">âœ… ÄÃ£ hoÃ n thÃ nh</h2>
<ul class="task-list">
<li><label><input type="checkbox" checked="" />Event-based labels sáº¡ch
(19 events)</label></li>
<li><label><input type="checkbox" checked="" />Static + Rainfall
features stack</label></li>
<li><label><input type="checkbox" checked="" />Dataset + Hard Negatives
Mining</label></li>
<li><label><input type="checkbox" checked="" />LOEO training + metrics
máº¡nh</label></li>
<li><label><input type="checkbox" checked="" />Xá»­ lÃ½ Data Leakage (bá»
water_mask)</label></li>
<li><label><input type="checkbox" checked="" />SHAP summary +
dependence</label></li>
<li><label><input type="checkbox" checked="" />EDA terrain
interaction</label></li>
<li><label><input type="checkbox" checked="" />Climate scenario (Rain
+20%)</label></li>
</ul>
<h2 id="cÃ²n-thiáº¿u-Ä‘á»ƒ-thÃ nh-paper">ğŸ”² CÃ²n thiáº¿u (Ä‘á»ƒ thÃ nh paper)</h2>
<ul class="task-list">
<li><label><input type="checkbox" /><strong>SHAP interaction plots Ä‘Ãºng
chuáº©n</strong></label>
<ul>
<li>Rain_7D vs SHAP colored by elev/dist_water</li>
</ul></li>
<li><label><input type="checkbox" /><strong>Climate aggregation Ä‘Ãºng
policy</strong></label>
<ul>
<li>Î”% area high-risk (P &gt; 0.7) theo event</li>
<li>Hoáº·c chá»‰ tÃ­nh trÃªn lowland mask</li>
</ul></li>
<li><label><input type="checkbox" /><strong>Spatial
outputs</strong></label>
<ul>
<li>Map P(x|e) cho vÃ i event tiÃªu biá»ƒu</li>
<li>Map Expected Frequency / Exceedance</li>
</ul></li>
<li><label><input type="checkbox" /><strong>Zonal
statistics</strong></label>
<ul>
<li>Top 10 huyá»‡n/xÃ£ rá»§i ro cao</li>
<li>Top 10 tÄƒng máº¡nh nháº¥t khi Rain +20%</li>
</ul></li>
</ul>
<hr />
<h1 id="thÆ°-viá»‡n-yÃªu-cáº§u">10. ThÆ° Viá»‡n YÃªu Cáº§u</h1>
<div class="sourceCode" id="cb13"><pre
class="sourceCode txt"><code class="sourceCode default"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>numpy pandas rasterio tqdm</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>xgboost scikit-learn</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>matplotlib seaborn shap</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>geopandas rasterstats (cho zonal)</span></code></pre></div>
<hr />
<p><em>Cáº­p nháº­t: 2026-02-05</em></p>
</body>
</html>
